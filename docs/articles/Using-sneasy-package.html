<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Social network analysis with the sneasy package • sneasy</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Social network analysis with the sneasy package">
<meta property="og:description" content="sneasy">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sneasy</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Using-sneasy-package.html">Social network analysis with the sneasy package</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/kturetsky/sneasy/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Social network analysis with the sneasy package</h1>
                        <h4 class="author">K. Turetsky</h4>
            
            <h4 class="date">March 2021</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/kturetsky/sneasy/blob/master/vignettes/Using-sneasy-package.Rmd"><code>vignettes/Using-sneasy-package.Rmd</code></a></small>
      <div class="hidden name"><code>Using-sneasy-package.Rmd</code></div>

    </div>

    
    
<p>The sneasy package contains a variety of helper functions used to make social network analysis easier. These functions were created for Group Dynamics Lab members and affiliates. Anyone can use the functions, with proper citation. However, many of the functions (e.g., buildnet) are quite specific to the way we set up data and the type of networks we study in our lab.</p>
<p>To use the sneasy package, you first need to install it from Github. You can do this with the following lines of code:</p>
<pre><code><a href="https://rdrr.io/r/utils/install.packages.html">install.packages("devtools")
devtools::install_github("kturetsky/sneasy")</a></code></pre>
<p>Next, load the sneasy package:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/kturetsky/sneasy">sneasy</a></span><span class="op">)</span></code></pre></div>
<p>The sneasy package contains four categories of functions: (1) functions for forming networks from collected data (<code>buildnet</code> and <code>attachatt</code>), (2) functions for calculating node-level network metrics, such as centrality (<code>centdf</code>), reciprocity (<code>tierecip</code>), and diversity (<code>simpsd</code>, <code>homophily</code>, <code>groupcount</code>), (3) shortcut functions to use in node permutation tests (<code>nodeperm</code> and <code>pperm</code>), and (4) a couple other additional functions that are often handy during SNA (<code>gmc</code> and <code>rescale01</code>). The package also contains sample data (<code>bionet</code> and <code>attfile</code>). You can always run <code><a href="../reference/buildnet.html">?buildnet</a></code>, <code><a href="../reference/attachatt.html">?attachatt</a></code>, etc. to view additional information about each function or dataset.</p>
<p>This vignette demonstrates how to use the sneasy package in social network analysis, beginning with forming networks in R from collected network data and ending with node permutation tests of significance.</p>
<div id="form-networks-from-collected-data" class="section level1">
<h1 class="hasAnchor">
<a href="#form-networks-from-collected-data" class="anchor"></a>Form networks from collected data</h1>
<p>The first step in lab social network analysis projects is typically to convert the network data you collected (e.g., in Qualtrics) to a network object in R. We typically use <code>igraph</code> network objects, which are called “graphs.”</p>
<p>The <code>buildnet</code> and <code>attachatt</code> functions in the sneasy package help you do this easily. However, you need to have your data set up in a particular way to use the functions.</p>
<div id="network-data-setup" class="section level2">
<h2 class="hasAnchor">
<a href="#network-data-setup" class="anchor"></a>Network data setup</h2>
<p>The data frame <code>bionet</code>, included in the sneasy package, demonstrates how network data should be set up. (Run <code><a href="../reference/bionet.html">?bionet</a></code> to read more about the dataset.) The data should be set up in wide format, with one row per participant. There should be a column called “PPID” that contains the IDs of your participants. The subsequent columns correspond to each participants’ nominations of network ties.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">bionet</span><span class="op">)</span>
<span class="co">#&gt;   PPID Friend1Name Friend2Name Friend3Name Friend4Name Friend5Name</span>
<span class="co">#&gt; 1    4          NA          NA          NA          NA          NA</span>
<span class="co">#&gt; 2   10         120         252         134         514          NA</span>
<span class="co">#&gt; 3   14         281          NA          NA          NA          NA</span>
<span class="co">#&gt; 4   15         389         410         445         531          NA</span>
<span class="co">#&gt; 5   18         546         487         385          48          94</span>
<span class="co">#&gt; 6   19          NA          NA          NA          NA          NA</span>
<span class="co">#&gt;   Friend6Name Friend1Strength Friend2Strength Friend3Strength</span>
<span class="co">#&gt; 1          NA              NA              NA              NA</span>
<span class="co">#&gt; 2          NA               5               5               3</span>
<span class="co">#&gt; 3          NA               4              NA              NA</span>
<span class="co">#&gt; 4          NA               3               4               3</span>
<span class="co">#&gt; 5         283               3               3               2</span>
<span class="co">#&gt; 6          NA              NA              NA              NA</span>
<span class="co">#&gt;   Friend4Strength Friend5Strength Friend6Strength Study1Name Study2Name</span>
<span class="co">#&gt; 1              NA              NA              NA         NA         NA</span>
<span class="co">#&gt; 2               1              NA              NA        120        252</span>
<span class="co">#&gt; 3              NA              NA              NA        281         NA</span>
<span class="co">#&gt; 4               4              NA              NA         NA         NA</span>
<span class="co">#&gt; 5               2               3               2        546        283</span>
<span class="co">#&gt; 6              NA              NA              NA         NA         NA</span>
<span class="co">#&gt;   Study3Name Study4Name Study5Name Study6Name Study1Strength</span>
<span class="co">#&gt; 1         NA         NA         NA         NA             NA</span>
<span class="co">#&gt; 2         NA         NA         NA         NA              2</span>
<span class="co">#&gt; 3         NA         NA         NA         NA              2</span>
<span class="co">#&gt; 4         NA         NA         NA         NA             NA</span>
<span class="co">#&gt; 5        385         96         94        487              1</span>
<span class="co">#&gt; 6         NA         NA         NA         NA             NA</span>
<span class="co">#&gt;   Study2Strength Study3Strength Study4Strength Study5Strength</span>
<span class="co">#&gt; 1             NA             NA             NA             NA</span>
<span class="co">#&gt; 2              2             NA             NA             NA</span>
<span class="co">#&gt; 3             NA             NA             NA             NA</span>
<span class="co">#&gt; 4             NA             NA             NA             NA</span>
<span class="co">#&gt; 5              1              1              1              1</span>
<span class="co">#&gt; 6             NA             NA             NA             NA</span>
<span class="co">#&gt;   Study6Strength Support1Name Support2Name Support3Name Support4Name</span>
<span class="co">#&gt; 1             NA           NA           NA           NA           NA</span>
<span class="co">#&gt; 2             NA          120          252           NA           NA</span>
<span class="co">#&gt; 3             NA           NA           NA           NA           NA</span>
<span class="co">#&gt; 4             NA           NA           NA           NA           NA</span>
<span class="co">#&gt; 5              3          546          487           NA           NA</span>
<span class="co">#&gt; 6             NA           NA           NA           NA           NA</span>
<span class="co">#&gt;   Support5Name Support6Name Support1Strength Support2Strength</span>
<span class="co">#&gt; 1           NA           NA               NA               NA</span>
<span class="co">#&gt; 2           NA           NA                1                1</span>
<span class="co">#&gt; 3           NA           NA               NA               NA</span>
<span class="co">#&gt; 4           NA           NA               NA               NA</span>
<span class="co">#&gt; 5           NA           NA                4                4</span>
<span class="co">#&gt; 6           NA           NA               NA               NA</span>
<span class="co">#&gt;   Support3Strength Support4Strength Support5Strength Support6Strength</span>
<span class="co">#&gt; 1               NA               NA               NA               NA</span>
<span class="co">#&gt; 2               NA               NA               NA               NA</span>
<span class="co">#&gt; 3               NA               NA               NA               NA</span>
<span class="co">#&gt; 4               NA               NA               NA               NA</span>
<span class="co">#&gt; 5               NA               NA               NA               NA</span>
<span class="co">#&gt; 6               NA               NA               NA               NA</span></code></pre></div>
<p>In this data, we have three network types. Participants nominated friends, study partners, and support providers. For each of the networks, the data contains two pieces of information for each nomination: who is nominated and an indication of the strength of the relationship.</p>
<div id="who-is-nominated" class="section level3">
<h3 class="hasAnchor">
<a href="#who-is-nominated" class="anchor"></a>Who is nominated</h3>
<p>The columns <code>Friend1Name</code>-<code>Friend6Name</code>, <code>Study1Name</code>-<code>Study6Name</code>, <code>Support1Name</code>-<code>Support6Name</code> contain the IDs of the individuals that each participant nominated. (In this case, each participant could nominate up to 6 friends, but it could be more or fewer in other studies.) For example, for the friend network, participant 4 did not nominate any friends and participant 10 nominated participants 120, 252, 134, and 514 as friends.</p>
<p>These columns <strong>must</strong> use the naming convention <code>[network type][nomination number][either 'Name' or 'ID']</code> – e.g., either <code>Friend1Name</code> or <code>Friend1ID</code>.</p>
</div>
<div id="strength-of-the-relationship" class="section level3">
<h3 class="hasAnchor">
<a href="#strength-of-the-relationship" class="anchor"></a>Strength of the relationship</h3>
<p>The columns <code>Friend1Strength</code>-<code>Friend6Strength</code>, <code>Study1Strength</code>-<code>Study6Strength</code>, <code>Support1Strength</code>-<code>Support6Strength</code> contain values corresponding to the strength of the respective relationship. These can be different types of relationship strength metrics. In this study, friendship strength was participants’ reported closeness to the friend they nominated on a scale from 1 (not very close) - 5 (very close), study partner strength was the amount that the participant reported studying with the study partner they nominated on a scale from 1 (once a month or less) - 3 (twice a week to every day), and support provider strength was the likelihood that the participant would go to the support provider for support with a problem on a scale from 1 (rarely) - 4 (always).</p>
<p>The naming convention for relationship strength variables is <code>[network type][nomination number][strength type]</code>. The first part, <code>[network type][nomination number]</code>, must exactly correspond to the “who is nominated” columns, and <code>[strength type]</code> can be any string – <code>Friend1Strength</code>, <code>Friend1Close</code>, etc. – but it’s easy to just use “Strength” if you only have one metric of relationship strength.</p>
</div>
<div id="additional-notes-on-data-setup" class="section level3">
<h3 class="hasAnchor">
<a href="#additional-notes-on-data-setup" class="anchor"></a>Additional notes on data setup</h3>
<p>The order of the columns does not matter but there must be one strength variable for each nomination (e.g., if we had a <code>Friend7Name</code> column, we would also need a <code>Friend7Strength</code> column). There could also be more than one strength variable for each nomination, if you have multiple metrics of relationship strength (e.g., <code>Friend7Close</code>, <code>Friend7TimeSpent</code>, <code>Friend7Phone</code>). The data also does not need to include multiple networks. It could just include one network type.</p>
</div>
</div>
<div id="convert-collected-data-to-network-matrix-or-edgelist" class="section level2">
<h2 class="hasAnchor">
<a href="#convert-collected-data-to-network-matrix-or-edgelist" class="anchor"></a>Convert collected data to network, matrix, or edgelist</h2>
<p>Next, we want to convert the wide social network data (as described above) into a usable network format. We can do this with <code>buildnet</code>. <code>buildnet</code> requires, at minimum, the wide social network data frame and a string containing the name of the network you want to process, matching the column names in the wide social network data (e.g., in the <code>bionet</code> data, this could either be “Friend”, “Study”, or “Support”). Unless otherwise specified, <code>buildnet</code> will return an igraph graph object. The graph will be weighted and directed.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/buildnet.html">buildnet</a></span><span class="op">(</span><span class="va">bionet</span>, <span class="st">"Friend"</span><span class="op">)</span>
<span class="va">fg</span>
<span class="co">#&gt; IGRAPH a85f4f6 DNW- 460 855 -- </span>
<span class="co">#&gt; + attr: name (v/c), weight (e/n)</span>
<span class="co">#&gt; + edges from a85f4f6 (vertex names):</span>
<span class="co">#&gt;  [1] 10-&gt;120 10-&gt;134 10-&gt;252 10-&gt;514 14-&gt;281 15-&gt;410 15-&gt;445 15-&gt;389</span>
<span class="co">#&gt;  [9] 15-&gt;531 18-&gt;94  18-&gt;283 18-&gt;385 18-&gt;487 18-&gt;546 18-&gt;48  23-&gt;106</span>
<span class="co">#&gt; [17] 23-&gt;316 23-&gt;1   24-&gt;168 24-&gt;328 24-&gt;417 24-&gt;344 24-&gt;259 24-&gt;59 </span>
<span class="co">#&gt; [25] 26-&gt;233 26-&gt;361 26-&gt;126 26-&gt;440 30-&gt;71  30-&gt;116 30-&gt;180 30-&gt;222</span>
<span class="co">#&gt; [33] 30-&gt;348 33-&gt;168 36-&gt;247 36-&gt;516 38-&gt;147 38-&gt;199 38-&gt;233 38-&gt;342</span>
<span class="co">#&gt; [41] 38-&gt;487 38-&gt;480 40-&gt;252 40-&gt;433 40-&gt;485 41-&gt;184 41-&gt;186 41-&gt;504</span>
<span class="co">#&gt; [49] 41-&gt;6   47-&gt;486 55-&gt;108 55-&gt;122 55-&gt;149 55-&gt;209 56-&gt;258 56-&gt;386</span>
<span class="co">#&gt; [57] 57-&gt;408 57-&gt;355 63-&gt;149 67-&gt;300 67-&gt;526 69-&gt;294 69-&gt;399 69-&gt;429</span>
<span class="co">#&gt; + ... omitted several edges</span></code></pre></div>
<p>If your data’s tie strength variables end in something different than “Strength,” you will need to specify the <code>weighttype</code> argument. For example, if your variables are named <code>Friend1Close</code>, <code>Friend2Close</code>, etc., you would run:</p>
<pre><code><a href="../reference/buildnet.html">buildnet(bionet, "Friend", weighttype = "Close")</a></code></pre>
<p>This function can also generate a network matrix or edgelist, instead of an igraph graph.</p>
<p><strong>Generate a matrix</strong></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fmat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/buildnet.html">buildnet</a></span><span class="op">(</span><span class="va">bionet</span>, <span class="st">"Friend"</span>, return <span class="op">=</span> <span class="st">"matrix"</span><span class="op">)</span>
<span class="va">fmat</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span><span class="op">]</span>
<span class="co">#&gt;    4 10 14 15 18 19 20 23 24 26</span>
<span class="co">#&gt; 4  0  0  0  0  0  0  0  0  0  0</span>
<span class="co">#&gt; 10 0  0  0  0  0  0  0  0  0  0</span>
<span class="co">#&gt; 14 0  0  0  0  0  0  0  0  0  0</span>
<span class="co">#&gt; 15 0  0  0  0  0  0  0  0  0  0</span>
<span class="co">#&gt; 18 0  0  0  0  0  0  0  0  0  0</span>
<span class="co">#&gt; 19 0  0  0  0  0  0  0  0  0  0</span>
<span class="co">#&gt; 20 0  0  0  0  0  0  0  0  0  0</span>
<span class="co">#&gt; 23 0  0  0  0  0  0  0  0  0  0</span>
<span class="co">#&gt; 24 0  0  0  0  0  0  0  0  0  0</span>
<span class="co">#&gt; 26 0  0  0  0  0  0  0  0  0  0</span></code></pre></div>
<p>In a network matrix, the row and column names correspond to each participant ID. The rows are the nominators and the columns are the nominated individuals (i.e., the first row are participant 4’s nominations of herself (0 by default), participant 10, participant 14, etc.). The value in each cell is either 0, representing no tie, or a value corresponding to the strength of the tie (i.e., 1-5 for the friend network in the <code>bionet</code> data). This particular network is very sparse, so this snippet of the matrix just looks like a bunch of zeroes, but other cells contain values 1-5.</p>
<p><strong>Generate an edgelist</strong></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fel</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/buildnet.html">buildnet</a></span><span class="op">(</span><span class="va">bionet</span>, <span class="st">"Friend"</span>, return <span class="op">=</span> <span class="st">"edgelist"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">fel</span><span class="op">)</span>
<span class="co">#&gt;   from  to weight</span>
<span class="co">#&gt; 1    4   4      0</span>
<span class="co">#&gt; 2   10 120      5</span>
<span class="co">#&gt; 3   14 281      4</span>
<span class="co">#&gt; 4   15 389      3</span>
<span class="co">#&gt; 5   18 546      3</span>
<span class="co">#&gt; 6   19  19      0</span></code></pre></div>
<p>Edgelists are a long form representation of the network, including one row per tie. The <code>from</code> column contains the nominator’s ID, <code>to</code> contains the nominated person’s ID, and <code>weight</code> contains the strength of the tie reported by the nominator. Edgelists produced by <code>buildnet</code> will include a self-nomination with a weight of 0 for individuals who did not nominate anyone. This is just to retain these individuals in the network as isolates (otherwise they would be dropped from the network for having no ties). You can always remove isolates from an igraph graph <code>g</code> later, using <code>delete.vertices(g, degree(g)==0)</code>.</p>
<p><strong>Missing tie strength data</strong></p>
<p>One additional item to consider is whether there is any missing tie strength data. Depending on how the networks were collected, a participant may occasionally nominate a tie but leave the tie strength rating blank for that nomination. <code>buildnet</code> retains these ties but must make an assumption about what the value of the tie should be. The default imputation is 1 (assuming the weakest tie if strength ratings begin at 1), but you can change this to any value (e.g., the mean tie strength, a fraction if your tie strength ratings range from 0-1, etc.).</p>
<p>For example, if you want to set missing tie weights to the mean friend tie strength rating, you could run:</p>
<pre><code><a href="../reference/buildnet.html">buildnet(bionet, "Friend", missingweight = mean((unlist(bionet[,8:13])), na.rm=TRUE))</a></code></pre>
<p><strong>Rescaling tie strength values</strong></p>
<p>If you have multiple networks with tie strength variables on different scales, as in the <code>bionet</code> data (friend strength ratings range from 1-5, study strength ratings range from 1-3, etc.), you may want to rescale them to be directly comparable using included function <code>rescale01</code>.</p>
<p>Current weights:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu">E</span><span class="op">(</span><span class="va">fg</span><span class="op">)</span><span class="op">$</span><span class="va">weight</span><span class="op">)</span>
<span class="co">#&gt; [1] 5 3 5 1 4 4</span></code></pre></div>
<p>Rescaled weights:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu"><a href="../reference/rescale01.html">rescale01</a></span><span class="op">(</span><span class="fu">E</span><span class="op">(</span><span class="va">fg</span><span class="op">)</span><span class="op">$</span><span class="va">weight</span>, min<span class="op">=</span><span class="fl">0</span>, max<span class="op">=</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] 1.0 0.6 1.0 0.2 0.8 0.8</span></code></pre></div>
<p>Remember that even though the strength ratings only range from 1-5, the minimum should be specified as 0, since 0 means no tie. Otherwise ratings of 1 will be converted to 0.</p>
<p>To save the rescaled values as the network weights, you would run:</p>
<pre><code>E(fg$weight) &lt;- rescale01(E(fg)$weight, min=0, max=5)</code></pre>
</div>
<div id="add-attributes-to-network" class="section level2">
<h2 class="hasAnchor">
<a href="#add-attributes-to-network" class="anchor"></a>Add attributes to network</h2>
<p>Next, we often want to attach participant attributes – individual-level data such as gender, race, attitude scales, etc. – to the network.</p>
<p>The sneasy package includes a data frame of attribute data, <code>attfile</code>, for each participant in <code>bionet</code>. This data was randomly generated and does not reflect the true attribute data of the students in <code>bionet</code>. In your data, the attribute data could be stored in a separate data frame, like this, or it could be stored in the same data frame as the network data.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">attfile</span><span class="op">)</span>
<span class="co">#&gt;   PPID gender   race age polorient</span>
<span class="co">#&gt; 1    4      F Latinx  18        20</span>
<span class="co">#&gt; 2   10      M SAsian  22        63</span>
<span class="co">#&gt; 3   14      M  White  18         5</span>
<span class="co">#&gt; 4   15      M EAsian  19        92</span>
<span class="co">#&gt; 5   18      F  White  21        75</span>
<span class="co">#&gt; 6   19      M  White  18        47</span></code></pre></div>
<p>To attach this data to the network, we can use <code>attachatt</code>. We need to give the function our network, the name of the data frame containing the attribute data, the index column in the attribute data containing the participant IDs that should be used to match attributes to the correct node names, and the variable names of the attributes we want to attach.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/attachatt.html">attachatt</a></span><span class="op">(</span><span class="va">fg</span>, <span class="va">attfile</span>, index<span class="op">=</span><span class="st">"PPID"</span>, attvars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"gender"</span>, <span class="st">"race"</span><span class="op">)</span><span class="op">)</span>
<span class="va">fg</span>
<span class="co">#&gt; IGRAPH a85f4f6 DNW- 460 855 -- </span>
<span class="co">#&gt; + attr: name (v/c), gender (v/c), race (v/c), weight (e/n)</span>
<span class="co">#&gt; + edges from a85f4f6 (vertex names):</span>
<span class="co">#&gt;  [1] 10-&gt;120 10-&gt;134 10-&gt;252 10-&gt;514 14-&gt;281 15-&gt;410 15-&gt;445 15-&gt;389</span>
<span class="co">#&gt;  [9] 15-&gt;531 18-&gt;94  18-&gt;283 18-&gt;385 18-&gt;487 18-&gt;546 18-&gt;48  23-&gt;106</span>
<span class="co">#&gt; [17] 23-&gt;316 23-&gt;1   24-&gt;168 24-&gt;328 24-&gt;417 24-&gt;344 24-&gt;259 24-&gt;59 </span>
<span class="co">#&gt; [25] 26-&gt;233 26-&gt;361 26-&gt;126 26-&gt;440 30-&gt;71  30-&gt;116 30-&gt;180 30-&gt;222</span>
<span class="co">#&gt; [33] 30-&gt;348 33-&gt;168 36-&gt;247 36-&gt;516 38-&gt;147 38-&gt;199 38-&gt;233 38-&gt;342</span>
<span class="co">#&gt; [41] 38-&gt;487 38-&gt;480 40-&gt;252 40-&gt;433 40-&gt;485 41-&gt;184 41-&gt;186 41-&gt;504</span>
<span class="co">#&gt; [49] 41-&gt;6   47-&gt;486 55-&gt;108 55-&gt;122 55-&gt;149 55-&gt;209 56-&gt;258 56-&gt;386</span>
<span class="co">#&gt; [57] 57-&gt;408 57-&gt;355 63-&gt;149 67-&gt;300 67-&gt;526 69-&gt;294 69-&gt;399 69-&gt;429</span>
<span class="co">#&gt; + ... omitted several edges</span></code></pre></div>
<p>Or if we want to attach all the variables in the attribute data frame (aside from the index column), we can just not include the <code>attvars</code> argument:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/attachatt.html">attachatt</a></span><span class="op">(</span><span class="va">fg</span>, <span class="va">attfile</span>, index<span class="op">=</span><span class="st">"PPID"</span><span class="op">)</span>
<span class="co">#&gt; Warning in attachatt(fg, attfile, index = "PPID"): List of attribute</span>
<span class="co">#&gt; variables not provided -- attaching all variables in attribute data aside</span>
<span class="co">#&gt; from index column.</span>
<span class="va">fg</span>
<span class="co">#&gt; IGRAPH a85f4f6 DNW- 460 855 -- </span>
<span class="co">#&gt; + attr: name (v/c), gender (v/c), race (v/c), age (v/n), polorient</span>
<span class="co">#&gt; | (v/n), weight (e/n)</span>
<span class="co">#&gt; + edges from a85f4f6 (vertex names):</span>
<span class="co">#&gt;  [1] 10-&gt;120 10-&gt;134 10-&gt;252 10-&gt;514 14-&gt;281 15-&gt;410 15-&gt;445 15-&gt;389</span>
<span class="co">#&gt;  [9] 15-&gt;531 18-&gt;94  18-&gt;283 18-&gt;385 18-&gt;487 18-&gt;546 18-&gt;48  23-&gt;106</span>
<span class="co">#&gt; [17] 23-&gt;316 23-&gt;1   24-&gt;168 24-&gt;328 24-&gt;417 24-&gt;344 24-&gt;259 24-&gt;59 </span>
<span class="co">#&gt; [25] 26-&gt;233 26-&gt;361 26-&gt;126 26-&gt;440 30-&gt;71  30-&gt;116 30-&gt;180 30-&gt;222</span>
<span class="co">#&gt; [33] 30-&gt;348 33-&gt;168 36-&gt;247 36-&gt;516 38-&gt;147 38-&gt;199 38-&gt;233 38-&gt;342</span>
<span class="co">#&gt; [41] 38-&gt;487 38-&gt;480 40-&gt;252 40-&gt;433 40-&gt;485 41-&gt;184 41-&gt;186 41-&gt;504</span>
<span class="co">#&gt; [49] 41-&gt;6   47-&gt;486 55-&gt;108 55-&gt;122 55-&gt;149 55-&gt;209 56-&gt;258 56-&gt;386</span>
<span class="co">#&gt; + ... omitted several edges</span></code></pre></div>
<p>This generates a warning message so that you know all variables in the attribute data frame are being attached; to suppress this message, you can include <code>attvars=NULL</code>.</p>
</div>
</div>
<div id="calculate-node-level-network-metrics" class="section level1">
<h1 class="hasAnchor">
<a href="#calculate-node-level-network-metrics" class="anchor"></a>Calculate node-level network metrics</h1>
<p>The next step is often to calculate node-level network metrics, such as node centrality, tie reciprocity, and diversity.</p>
<div id="node-centrality" class="section level2">
<h2 class="hasAnchor">
<a href="#node-centrality" class="anchor"></a>Node centrality</h2>
<p>The <code>centdf</code> function generates a data frame of centrality measures for each node in a network. The available centrality measures are: degree, betweenness, closeness, harmonic closeness, strength, average strength (strength divided by number of ties), and eigenvector.</p>
<p>You can tell <code>centdf</code> which of these centralities you want to calculate:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/centdf.html">centdf</a></span><span class="op">(</span><span class="va">fg</span>, pps <span class="op">=</span> <span class="cn">NULL</span>, types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"degree"</span>, <span class="st">"betweenness"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">cd</span><span class="op">)</span>
<span class="co">#&gt;   PPID gender   race age polorient degree degin degout  btwn</span>
<span class="co">#&gt; 1    4      F Latinx  18        20      0     0      0   0.0</span>
<span class="co">#&gt; 2   10      M SAsian  22        63      7     3      4 114.0</span>
<span class="co">#&gt; 3   14      M  White  18         5      2     1      1   0.0</span>
<span class="co">#&gt; 4   15      M EAsian  19        92      5     1      4 617.5</span>
<span class="co">#&gt; 5   18      F  White  21        75      9     3      6  81.0</span>
<span class="co">#&gt; 6   19      M  White  18        47      2     2      0   0.0</span></code></pre></div>
<p>Or you can have <code>centdf</code> calculate all of the centrality measures it has available. However, it is important to note that some centrality measures are not mathematically well-defined in disconnected networks (networks where some nodes are not connected to other nodes by any direct or indirect path – e.g., if there are isolates or disconnected components).</p>
<p>You can check if your network is connected using a function from the igraph package:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">is_connected</span><span class="op">(</span><span class="va">fg</span><span class="op">)</span>
<span class="co">#&gt; [1] FALSE</span></code></pre></div>
<p>Since the <code>bionet</code> network is disconnected, if we want <code>centdf</code> to calculate all of the centrality measures, we should use <code>types = "alldisconnect"</code> instead of <code>types = "all"</code>. If you try to use <code>types = "all"</code> on a disconnected network, you will get warning messages.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/centdf.html">centdf</a></span><span class="op">(</span><span class="va">fg</span>, pps <span class="op">=</span> <span class="cn">NULL</span>, types <span class="op">=</span> <span class="st">"alldisconnect"</span><span class="op">)</span>
<span class="co">#&gt; Registered S3 method overwritten by 'GGally':</span>
<span class="co">#&gt;   method from   </span>
<span class="co">#&gt;   +.gg   ggplot2</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">cd</span><span class="op">)</span>
<span class="co">#&gt;   PPID gender   race age polorient degree degin degout  btwn   hclose</span>
<span class="co">#&gt; 1    4      F Latinx  18        20      0     0      0   0.0  0.00000</span>
<span class="co">#&gt; 2   10      M SAsian  22        63      7     3      4 114.0 23.85261</span>
<span class="co">#&gt; 3   14      M  White  18         5      2     1      1   0.0 18.56747</span>
<span class="co">#&gt; 4   15      M EAsian  19        92      5     1      4 617.5 29.71935</span>
<span class="co">#&gt; 5   18      F  White  21        75      9     3      6  81.0 24.26585</span>
<span class="co">#&gt; 6   19      M  White  18        47      2     2      0   0.0 27.99306</span>
<span class="co">#&gt;    hclosein hcloseout strength strin strout avgstrength avgstrin avgstrout</span>
<span class="co">#&gt; 1 0.0000000  0.000000        0     0      0    0.000000 0.000000       0.0</span>
<span class="co">#&gt; 2 7.4058915 11.433904       26    12     14    3.714286 4.000000       3.5</span>
<span class="co">#&gt; 3 0.9604729  5.090868        7     3      4    3.500000 3.000000       4.0</span>
<span class="co">#&gt; 4 5.9435839  9.440896       17     3     14    3.400000 3.000000       3.5</span>
<span class="co">#&gt; 5 2.8969839  6.686432       25    10     15    2.777778 3.333333       2.5</span>
<span class="co">#&gt; 6 8.7684769  0.000000        5     5      0    2.500000 2.500000       0.0</span></code></pre></div>
<p>As you can see, the <code>centdf</code> default is to include total, in, and out centrality where applicable (e.g., “degree”, “degin”, “degout”). If you only want the total centrality, you can use <code>inout = FALSE</code>:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/centdf.html">centdf</a></span><span class="op">(</span><span class="va">fg</span>, pps <span class="op">=</span> <span class="cn">NULL</span>, types <span class="op">=</span> <span class="st">"alldisconnect"</span>, inout <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">cd</span><span class="op">)</span>
<span class="co">#&gt;   PPID gender   race age polorient degree  btwn   hclose strength</span>
<span class="co">#&gt; 1    4      F Latinx  18        20      0   0.0  0.00000        0</span>
<span class="co">#&gt; 2   10      M SAsian  22        63      7 114.0 23.85261       26</span>
<span class="co">#&gt; 3   14      M  White  18         5      2   0.0 18.56747        7</span>
<span class="co">#&gt; 4   15      M EAsian  19        92      5 617.5 29.71935       17</span>
<span class="co">#&gt; 5   18      F  White  21        75      9  81.0 24.26585       25</span>
<span class="co">#&gt; 6   19      M  White  18        47      2   0.0 27.99306        5</span>
<span class="co">#&gt;   avgstrength</span>
<span class="co">#&gt; 1    0.000000</span>
<span class="co">#&gt; 2    3.714286</span>
<span class="co">#&gt; 3    3.500000</span>
<span class="co">#&gt; 4    3.400000</span>
<span class="co">#&gt; 5    2.777778</span>
<span class="co">#&gt; 6    2.500000</span></code></pre></div>
<p>Note that the <code>pps</code> argument can be used to control who is included in the data frame produced by <code>centdf</code>. This is useful if not everyone included in the network participated in the study or completed network measures. For example, in a classroom of 100 students, perhaps only 95 students took the survey. The remaining 5 students may be included in the network if they were named as friends by the 95 participants, but they did not have a chance to nominate friends themselves. Thus, you may want to limit the centralities you are studying to the 95 students who participated fully. In this case, you would feed the <code>pps</code> argument a vector of the participant IDs that should be included in the data frame (instead of <code>pps = NULL</code>, which will include everyone in the network regardless of whether they were participants). For example:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/centdf.html">centdf</a></span><span class="op">(</span><span class="va">fg</span>, pps <span class="op">=</span> <span class="va">bionet</span><span class="op">$</span><span class="va">PPID</span>, types <span class="op">=</span> <span class="st">"alldisconnect"</span>, inout <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<div id="additional-options" class="section level3">
<h3 class="hasAnchor">
<a href="#additional-options" class="anchor"></a>Additional options</h3>
<p><strong>Normalization:</strong> Some types of centrality can be normalized (degree, betweenness, closeness, and harmonic closeness). Use the <code>norm</code> argument to specify which centralities you want normalized (default is none). For example, if you just want degree normalized, you can use <code>norm = "degree"</code>; if you want all applicable centrality measures normalized, you can use <code>norm = "all"</code>.</p>
<p><strong>Attributes:</strong> By default, <code>centdf</code> will include node attributes in the generated data frame. If you don’t want the attributes included, use <code>include_atts = FALSE</code>.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/centdf.html">centdf</a></span><span class="op">(</span><span class="va">fg</span>, pps <span class="op">=</span> <span class="cn">NULL</span>, types <span class="op">=</span> <span class="st">"alldisconnect"</span>, norm <span class="op">=</span> <span class="st">"all"</span>, 
            inout <span class="op">=</span> <span class="cn">FALSE</span>, include_atts <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">cd</span><span class="op">)</span>
<span class="co">#&gt;   PPID      degree         btwn     hclose strength avgstrength</span>
<span class="co">#&gt; 1    4 0.000000000 0.0000000000 0.00000000        0    0.000000</span>
<span class="co">#&gt; 2   10 0.015250545 0.0005422839 0.05196648       26    3.714286</span>
<span class="co">#&gt; 3   14 0.004357298 0.0000000000 0.04045200        7    3.500000</span>
<span class="co">#&gt; 4   15 0.010893246 0.0029373710 0.06474805       17    3.400000</span>
<span class="co">#&gt; 5   18 0.019607843 0.0003853070 0.05286678       25    2.777778</span>
<span class="co">#&gt; 6   19 0.004357298 0.0000000000 0.06098707        5    2.500000</span></code></pre></div>
</div>
</div>
<div id="tie-reciprocity" class="section level2">
<h2 class="hasAnchor">
<a href="#tie-reciprocity" class="anchor"></a>Tie reciprocity</h2>
<p>In addition to centrality, you may want to know what proportion of individuals nominated by a participant nominated that participant back. For example, if A nominated B and C, but only C nominated A back, A’s reciprocity would be 0.5.</p>
<p><code>tierecip</code> calculates proportion of reciprocal ties for each node. It takes an edgelist instead of an igraph graph, so we will use the edgelist we created earlier, <code>fel</code>.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tierecip.html">tierecip</a></span><span class="op">(</span><span class="va">fel</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">rd</span><span class="op">)</span>
<span class="co">#&gt;   PPID recip</span>
<span class="co">#&gt; 1   10  0.75</span>
<span class="co">#&gt; 2  102  0.50</span>
<span class="co">#&gt; 3  103   NaN</span>
<span class="co">#&gt; 4  105  0.50</span>
<span class="co">#&gt; 5  107  1.00</span>
<span class="co">#&gt; 6  108  0.50</span></code></pre></div>
<p>Note that in the case discussed above where not all people included in a network actually completed network surveys, we will also want to account for that here. Using <code>type = "complete"</code> calculates reciprocity based only on nominees who completed the network survey (so had a chance to nominate the participant back).</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tierecip.html">tierecip</a></span><span class="op">(</span><span class="va">fel</span>, type <span class="op">=</span> <span class="st">"complete"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">rd</span><span class="op">)</span>
<span class="co">#&gt;   PPID recip_comp</span>
<span class="co">#&gt; 1   10  1.0000000</span>
<span class="co">#&gt; 2  102  0.7500000</span>
<span class="co">#&gt; 3  103        NaN</span>
<span class="co">#&gt; 4  105  0.6666667</span>
<span class="co">#&gt; 5  107  1.0000000</span>
<span class="co">#&gt; 6  108  0.6666667</span></code></pre></div>
</div>
<div id="tie-diversity" class="section level2">
<h2 class="hasAnchor">
<a href="#tie-diversity" class="anchor"></a>Tie diversity</h2>
<p>Another common node-level metric we calculate is the diversity of each individuals’ ties. The sneasy package includes three functions to calculate different types of diversity: <code>simpsd</code>, <code>homophily</code>, and <code>groupcount</code>.</p>
<div id="simpsons-d" class="section level3">
<h3 class="hasAnchor">
<a href="#simpsons-d" class="anchor"></a>Simpson’s D</h3>
<p>Simpson’s D is dual concept measure of diversity taking into account both the number of groups represented, in this case, in an individual’s network ties, as well as how evenly distributed the ties are among these groups. Higher values of Simpson’s D represent a more even distribution of groups and thus more diversity. For example, if there are four racial groups, a person with 25% Asian friends, 25% Black friends, 25% Latinx friends, and 25% White friends would have the most diverse friend group possible according to Simpson’s D.</p>
<p>We can calculate Simpson’s D based on any categorical attribute attached to the network.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simpsd.html">simpsd</a></span><span class="op">(</span><span class="va">fg</span>, dim <span class="op">=</span> <span class="st">"race"</span><span class="op">)</span>
<span class="co">#&gt; Some nodes are missing race data. Dropping 132 node(s) for Simpson's D calculation.</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">sd</span><span class="op">)</span>
<span class="co">#&gt;   PPID   race simpsd_race</span>
<span class="co">#&gt; 1   10 SAsian   0.6666667</span>
<span class="co">#&gt; 2  102  White   0.6250000</span>
<span class="co">#&gt; 3  103  White         NaN</span>
<span class="co">#&gt; 4  105  White   0.4444444</span>
<span class="co">#&gt; 5  107  Black   0.0000000</span>
<span class="co">#&gt; 6  108 SAsian   0.6666667</span></code></pre></div>
<p>Note that if any nodes are missing attribute data, the function will drop them with a message indicating how many nodes were dropped.</p>
<p>Also, Simpson’s D will always be <code>NaN</code> for individuals with no ties in the network.</p>
<p>With its default calculation, Simpson’s D can be interpreted as the probability that two individuals picked at random come from the same group. The maximum value of Simpson’s D will decrease as the number of groups increases. However, you may instead want to calculate the standardized version of Simpson’s D where 1 = the maximum diversity and 0 = the minimum diversity regardless of the number of groups. In this case, use the <code>std</code> argument:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simpsd.html">simpsd</a></span><span class="op">(</span><span class="va">fg</span>, dim <span class="op">=</span> <span class="st">"race"</span>, std <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; Some nodes are missing race data. Dropping 132 node(s) for Simpson's D calculation.</span>
<span class="co">#&gt; Calculating standardized Simpson's D assuming the following are all possible values of race: Latinx, SAsian, White, EAsian, Multi, Black</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">sd</span><span class="op">)</span>
<span class="co">#&gt;   PPID   race simpsd_race_std</span>
<span class="co">#&gt; 1   10 SAsian       0.8000000</span>
<span class="co">#&gt; 2  102  White       0.7500000</span>
<span class="co">#&gt; 3  103  White             NaN</span>
<span class="co">#&gt; 4  105  White       0.5333333</span>
<span class="co">#&gt; 5  107  Black       0.0000000</span>
<span class="co">#&gt; 6  108 SAsian       0.8000000</span></code></pre></div>
<p>The function will automatically calculate Simpson’s D based on all (non-NA) values of the attribute present in the data. If there are values of the attribute that do not appear in the data but you want to include them in the calculation, you can use the <code>values</code> argument. The example below calculates Simpson’s D assuming that American Indian is also one of the races of interest though it did not appear in this data. Note that this will only make a difference in the calculation of the standardized version of Simpson’s D, which is why you only get a message about the attribute values included if you are calculating the standardized version.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simpsd.html">simpsd</a></span><span class="op">(</span><span class="va">fg</span>, dim <span class="op">=</span> <span class="st">"race"</span>, std <span class="op">=</span> <span class="cn">TRUE</span>, values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Black"</span>, <span class="st">"Latinx"</span>, <span class="st">"EAsian"</span>, <span class="st">"SAsian"</span>, <span class="st">"White"</span>, <span class="st">"Multi"</span>, <span class="st">"AmerIndian"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Some nodes are missing race data. Dropping 132 node(s) for Simpson's D calculation.</span>
<span class="co">#&gt; Warning in simpsd(fg, dim = "race", std = TRUE, values = c("Black",</span>
<span class="co">#&gt; "Latinx", : One or more provided values of 'race' do not appear in network</span>
<span class="co">#&gt; but are included in calculation: AmerIndian</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">sd</span><span class="op">)</span>
<span class="co">#&gt;   PPID   race simpsd_race_std</span>
<span class="co">#&gt; 1   10 SAsian       0.7777778</span>
<span class="co">#&gt; 2  102  White       0.7291667</span>
<span class="co">#&gt; 3  103  White             NaN</span>
<span class="co">#&gt; 4  105  White       0.5185185</span>
<span class="co">#&gt; 5  107  Black       0.0000000</span>
<span class="co">#&gt; 6  108 SAsian       0.7777778</span></code></pre></div>
<p>If you wish to calculate Simpson’s D excluding one value of the attribute (e.g., if you want to calculate diversity based only on people with one race, excluding multiracial participants), then you should remove nodes with that value of the attribute before calculating diversity. You will get an error message if you try to calculate Simpson’s D only on a subset of values in the data, like the following, with “Multi” missing from <code>values</code>:</p>
<pre><code>sd &lt;- simpsd(fg, dim = "race", values=c("Black", "Latinx", "EAsian", "SAsian", "White"))</code></pre>
<p>Instead you can remove the nodes first using a function from the <code>igraph</code> package, and then calculate Simpson’s D:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fg2</span> <span class="op">&lt;-</span> <span class="fu">delete.vertices</span><span class="op">(</span><span class="va">fg</span>, <span class="fu">V</span><span class="op">(</span><span class="va">fg</span><span class="op">)</span><span class="op">[</span><span class="fu">get.vertex.attribute</span><span class="op">(</span><span class="va">fg</span>, <span class="st">"race"</span><span class="op">)</span> <span class="op">%in%</span> <span class="st">"Multi"</span><span class="op">]</span><span class="op">)</span>
<span class="va">sd2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simpsd.html">simpsd</a></span><span class="op">(</span><span class="va">fg2</span>, dim <span class="op">=</span> <span class="st">"race"</span><span class="op">)</span>
<span class="co">#&gt; Some nodes are missing race data. Dropping 132 node(s) for Simpson's D calculation.</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">sd2</span><span class="op">)</span>
<span class="co">#&gt;   PPID   race simpsd_race</span>
<span class="co">#&gt; 1   10 SAsian   0.5000000</span>
<span class="co">#&gt; 2  102  White   0.4444444</span>
<span class="co">#&gt; 3  103  White         NaN</span>
<span class="co">#&gt; 4  105  White   0.4444444</span>
<span class="co">#&gt; 5  107  Black   0.0000000</span>
<span class="co">#&gt; 6  108 SAsian   0.6666667</span></code></pre></div>
<p><strong>Additional options</strong></p>
<p><strong>Mode:</strong> By default, Simpson’s D is calculated based on all ties of a node (both incoming and outgoing). If you want to calculate Simpson’s D based only on outgoing or incoming ties, use <code>mode = "out"</code> or <code>mode = "in"</code>.</p>
<p><strong>Attributes:</strong> By default, <code>simpsd</code> will include a column containing node values of specified dimension (here, race). If you don’t want this attribute column included, use <code>include_att = FALSE</code>.</p>
</div>
<div id="homophily" class="section level3">
<h3 class="hasAnchor">
<a href="#homophily" class="anchor"></a>Homophily</h3>
<p>Homophily reflects how many of an individuals’ social ties belong to the same group as they do.</p>
<p>The default version of homophily will be a proportion of same-group ties ranging from 0 (no ties belong to the same group as the individual) to 1 (all same-group ties). For example, a Latinx person with 1 Asian friend, 1 Black friend, 1 Latinx friend, and 1 White friend has a racial homophily of 0.25. A woman who has all female friends has a gender homophily of 1.0.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">hd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/homophily.html">homophily</a></span><span class="op">(</span><span class="va">fg</span>, dim <span class="op">=</span> <span class="st">"race"</span><span class="op">)</span>
<span class="co">#&gt; Some nodes are missing race data. Dropping 132 node(s) for homophily calculation.</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">hd</span><span class="op">)</span>
<span class="co">#&gt;   PPID   race homoph_race</span>
<span class="co">#&gt; 1    4 Latinx         NaN</span>
<span class="co">#&gt; 2   10 SAsian         0.0</span>
<span class="co">#&gt; 3   14  White         0.0</span>
<span class="co">#&gt; 4   15 EAsian         0.0</span>
<span class="co">#&gt; 5   18  White         0.2</span>
<span class="co">#&gt; 6   19  White         0.5</span></code></pre></div>
<p>As with Simpson’s D, if any nodes are missing attribute data, the function will drop them with a message indicating how many nodes were dropped. Homophily will also be <code>NaN</code> for anyone with no ties in the network.</p>
<p>Homophily can also be adjusted based on the underlying proportion of same-group individuals in the network. The adjusted version takes into account the baseline probability of developing same-group ties based on the network’s composition. For example, a White person with three White friends in a network with 95% White people will have a lower adjusted homophily score than a White person with three White friends in a network with 5% White people. The adjusted homophily score ranges from -1 to 1, where -1 indicates fewer same-group ties than expected based on network composition, 0 indicates the same amount of same-group ties as expected based on network composition, and 1 indicates more same-group ties than expected based on network composition. This adjustment is useful when the network contains unequally sized groups.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">hd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/homophily.html">homophily</a></span><span class="op">(</span><span class="va">fg</span>, dim <span class="op">=</span> <span class="st">"race"</span>, adj <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; Some nodes are missing race data. Dropping 132 node(s) for homophily calculation.</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">hd</span><span class="op">)</span>
<span class="co">#&gt;   PPID   race homoph_race_adj</span>
<span class="co">#&gt; 1    4 Latinx             NaN</span>
<span class="co">#&gt; 2   10 SAsian      -1.0000000</span>
<span class="co">#&gt; 3   14  White      -1.0000000</span>
<span class="co">#&gt; 4   15 EAsian      -1.0000000</span>
<span class="co">#&gt; 5   18  White      -0.2282353</span>
<span class="co">#&gt; 6   19  White       0.9294118</span></code></pre></div>
<p><strong>Additional options</strong></p>
<p><strong>Mode:</strong> By default, homophily is calculated based on all ties of a node (both incoming and outgoing). If you want to calculate homophily based only on outgoing or incoming ties, use <code>mode = "out"</code> or <code>mode = "in"</code>.</p>
<p><strong>Attributes:</strong> By default, <code>homophily</code> will include a column containing node values of specified dimension (here, race). If you don’t want this attribute column included, use <code>include_att = FALSE</code>.</p>
</div>
<div id="group-count" class="section level3">
<h3 class="hasAnchor">
<a href="#group-count" class="anchor"></a>Group count</h3>
<p>Group count is simply a count of the number of groups represented among a person’s social ties. For example, if someone has one Asian friend, two Black friends, and a White friend, their group count for race would be 3.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">gcd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/groupcount.html">groupcount</a></span><span class="op">(</span><span class="va">fg</span>, dim <span class="op">=</span> <span class="st">"race"</span><span class="op">)</span>
<span class="co">#&gt; Some nodes are missing race data. Dropping 132 node(s) for group count calculation.</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">gcd</span><span class="op">)</span>
<span class="co">#&gt;   PPID   race ngroup_race</span>
<span class="co">#&gt; 1    4 Latinx         NaN</span>
<span class="co">#&gt; 2   10 SAsian           3</span>
<span class="co">#&gt; 3   14  White           1</span>
<span class="co">#&gt; 4   15 EAsian           2</span>
<span class="co">#&gt; 5   18  White           5</span>
<span class="co">#&gt; 6   19  White           2</span></code></pre></div>
<p>Same as with the other diversity measures, if any nodes are missing attribute data, the function will drop them with a message indicating how many nodes were dropped, and group count will be <code>NaN</code> for anyone with no ties in the network.</p>
<p>If you want to include the ego’s group (the group of the person doing the nominating/being nominated) in the group count in addition to their friends’ groups, you can do so:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">gcd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/groupcount.html">groupcount</a></span><span class="op">(</span><span class="va">fg</span>, dim <span class="op">=</span> <span class="st">"race"</span>, include_ego <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; Some nodes are missing race data. Dropping 132 node(s) for group count calculation.</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">gcd</span><span class="op">)</span>
<span class="co">#&gt;   PPID   race ngroup_race_wego</span>
<span class="co">#&gt; 1    4 Latinx              NaN</span>
<span class="co">#&gt; 2   10 SAsian                4</span>
<span class="co">#&gt; 3   14  White                2</span>
<span class="co">#&gt; 4   15 EAsian                3</span>
<span class="co">#&gt; 5   18  White                5</span>
<span class="co">#&gt; 6   19  White                2</span></code></pre></div>
<p>If instead of the number of groups represented, you want the function to return the fraction of total groups in the network represented among each nodes’ ties, use <code>adj = TRUE</code>.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">gcd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/groupcount.html">groupcount</a></span><span class="op">(</span><span class="va">fg</span>, dim <span class="op">=</span> <span class="st">"race"</span>, adj <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; Some nodes are missing race data. Dropping 132 node(s) for group count calculation.</span>
<span class="co">#&gt; Calculating adjusted group count assuming the following are all possible values of race: Latinx, SAsian, White, EAsian, Multi, Black</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">gcd</span><span class="op">)</span>
<span class="co">#&gt;   PPID   race ngroup_race_adj</span>
<span class="co">#&gt; 1    4 Latinx             NaN</span>
<span class="co">#&gt; 2   10 SAsian       0.5000000</span>
<span class="co">#&gt; 3   14  White       0.1666667</span>
<span class="co">#&gt; 4   15 EAsian       0.3333333</span>
<span class="co">#&gt; 5   18  White       0.8333333</span>
<span class="co">#&gt; 6   19  White       0.3333333</span></code></pre></div>
<p><strong>Additional options</strong></p>
<p><strong>Values:</strong> As with Simpson’s D, the function will automatically calculate group count based on all (non-NA) values of the attribute present in the data. If there are values of the attribute that do not appear in the data but you want to include them in the calculation, you can use the same <code>values</code> argument as in Simpson’s D. Again, this will only make a difference in the calculation of the adjusted group count, which is why you only get a message about the attribute values included if you are calculating the adjusted version.</p>
<p><strong>Mode:</strong> By default, group count is calculated based on all ties of a node (both incoming and outgoing). If you want to calculate group count based only on outgoing or incoming ties, use <code>mode = "out"</code> or <code>mode = "in"</code>.</p>
<p><strong>Attributes:</strong> By default, <code>groupcount</code> will include a column containing node values of specified dimension (here, race). If you don’t want this attribute column included, use <code>include_att = FALSE</code>.</p>
</div>
</div>
</div>
<div id="shortcuts-for-running-node-permutation-tests" class="section level1">
<h1 class="hasAnchor">
<a href="#shortcuts-for-running-node-permutation-tests" class="anchor"></a>Shortcuts for running node permutation tests</h1>
<p>Often when we are using network variables as either predictors or dependent variables, our data will violate the assumption of independent observations required for traditional null hypothesis significance testing. In this case, we may instead want to use node permutation tests to assess the statistical significance of observed effects. These nonparametric tests compare the observed effects to a null model based on randomization of data across the network, while holding the underlying structure of the network constant. (See Turetsky et al., 2020, <em>Science Advances</em>, for an example and Farine, 2007, <em>Methods in Ecology and Evolution</em>, p. 2 for a brief generalized overview of these tests).</p>
<p>Let’s say we want to know whether there is an age difference in network centrality in the <code>bionet</code> data. (Remember that the attributes for this network are randomly generated, so we do not actually expect to see a difference here, but let’s pretend!) Specifically, let’s test if there is an age difference in degree centrality (total number of friends). First, we’ll prepare our dataset:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/centdf.html">centdf</a></span><span class="op">(</span><span class="va">fg</span>, pps <span class="op">=</span> <span class="va">bionet</span><span class="op">$</span><span class="va">PPID</span>, types <span class="op">=</span> <span class="st">"degree"</span>, inout <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">gender</span>, <span class="op">-</span><span class="va">race</span>, <span class="op">-</span><span class="va">polorient</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span>
<span class="co">#&gt;   PPID age degree</span>
<span class="co">#&gt; 1    4  18      0</span>
<span class="co">#&gt; 2   10  22      7</span>
<span class="co">#&gt; 3   14  18      2</span>
<span class="co">#&gt; 4   15  19      5</span>
<span class="co">#&gt; 5   18  21      9</span>
<span class="co">#&gt; 6   19  18      2</span></code></pre></div>
<p>Next, we run a standard linear model regressing degree centrality on age:</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">degree</span> <span class="op">~</span> <span class="va">age</span>, data <span class="op">=</span> <span class="va">d</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; lm(formula = degree ~ age, data = d)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residuals:</span>
<span class="co">#&gt;     Min      1Q  Median      3Q     Max </span>
<span class="co">#&gt; -5.1067 -3.1764 -0.1764  2.5135 10.5135 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)</span>
<span class="co">#&gt; (Intercept)  -1.4057     4.3746  -0.321    0.748</span>
<span class="co">#&gt; age           0.3101     0.2340   1.326    0.186</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residual standard error: 3.481 on 326 degrees of freedom</span>
<span class="co">#&gt; Multiple R-squared:  0.005361,   Adjusted R-squared:  0.002309 </span>
<span class="co">#&gt; F-statistic: 1.757 on 1 and 326 DF,  p-value: 0.1859</span></code></pre></div>
<p>This model suggests that an increase of one year in age is associated with a 0.31 increase in degree centrality (SE = 0.23). However, to test whether this effect is significantly different from what we would expect by chance, we need to test it against a null model that takes into account the network structure.</p>
<p>To create this null model, we will “permute” the network – i.e., keep the underlying network the same, but randomly shuffle the attributes associated with each node, including age – some large number of times (here we will do 10,000 permutations). For each permutation of the network, we will calculate each node’s new centrality and then run the same linear model as above, extracting the coefficient of the effect of age on degree centrality. This will give us 10,000 age coefficients that form a distribution of the effects of age that we would expect purely by chance based on the network structure (the null distribution), against which we can compare our observed age coefficient (0.31).</p>
<p>First, set the number of permutations you are going to run, save the observed age coefficient, and set up an empty vector that will store all your age coefficients estimated based on permuted networks</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">perms</span> <span class="op">&lt;-</span> <span class="fl">10000</span>
<span class="va">age.obs</span> <span class="op">&lt;-</span> <span class="va">m</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>
<span class="va">age.perm</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></code></pre></div>
<p>Next, we will run all the permutations. <code>nodeperm</code> creates a permuted network (<code>igraph</code> graph object) from the network matrix (created earlier using <code>buildnet</code>). We attach age back to this network using <code>attachatt</code>. We then recalculate degree on the permuted network using <code>centdf</code>. Finally, we run the same model as above, but on the permuted data, and save the age coefficient from the model in the empty vector we just initialized.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">perms</span><span class="op">)</span><span class="op">{</span>

  <span class="va">fgperm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nodeperm.html">nodeperm</a></span><span class="op">(</span><span class="va">fmat</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="../reference/attachatt.html">attachatt</a></span><span class="op">(</span><span class="va">attfile</span>, index <span class="op">=</span> <span class="st">"PPID"</span>, attvars <span class="op">=</span> <span class="st">"age"</span><span class="op">)</span>

  <span class="va">dperm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/centdf.html">centdf</a></span><span class="op">(</span><span class="va">fgperm</span>, pps <span class="op">=</span> <span class="va">bionet</span><span class="op">$</span><span class="va">PPID</span>, types <span class="op">=</span> <span class="st">"degree"</span>, inout <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>

  <span class="va">mperm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">degree</span> <span class="op">~</span> <span class="va">age</span>, <span class="va">dperm</span><span class="op">)</span>
  <span class="va">age.perm</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">mperm</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>

  <span class="co">#print(i)</span>
<span class="op">}</span></code></pre></div>
<p><em>Note: This loop will take a while to run. If you want to be sure the loop is progressing and know how close it is to being done, you can un-comment <code><a href="https://rdrr.io/r/base/print.html">print(i)</a></code>, which will print out the number permutation the loop is on.</em></p>
<p>To finish the test, we use null distribution of age coefficients that we just created to calculate the probability that we would have observed an effect of age as large as (or larger than) our observed coefficient (0.31) purely by chance. This probability is an exact p-value, p<sub>perm</sub>. It can be compared to the criterion for significance (e.g., .05) in the way one would normally use a p-value, where p<sub>perm</sub> &lt; .05 is significant (indicating that we would observe an effect as large as our observed effect less than 5% of the time if individuals were completely randomly distributed across the network) and p<sub>perm</sub> &gt; .05 is not significant (indicating that we would observe an effect as large as our observed effect greater than 5% of the time if individuals were completely randomly distributed across the network).</p>
<p>The <code>pperm</code> function returns p<sub>perm</sub> as well as a plot showing the null distribution of coefficients calculated on permuted networks (green bars), cut offs for significance (red lines), and the observed coefficient (black dotted line). You can determine significance both numerically by comparing p<sub>perm</sub> to your criterion for signifiance and visually by examining whether the black dotted line falls within the red lines (not significant) or outside the red lines (significant). The default significance criterion is .05, so if you don’t change this, the red lines will demarcate the middle 95% of the distribution from the outer 5% of the distribution.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/pperm.html">pperm</a></span><span class="op">(</span><span class="va">age.obs</span>, <span class="va">age.perm</span><span class="op">)</span>
<span class="co">#&gt; $p.perm</span>
<span class="co">#&gt; [1] 0.1466</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $plot</span></code></pre></div>
<p><img src="Using-sneasy-package_files/figure-html/unnamed-chunk-33-1.png" width="700"></p>
<p>If you are using a different significance criterion, you can specify that. You can also include a name for the coefficient you are examining if you want the x-axis label to be more precise.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/pperm.html">pperm</a></span><span class="op">(</span><span class="va">age.obs</span>, <span class="va">age.perm</span>, alpha <span class="op">=</span> <span class="fl">.01</span>, coefname <span class="op">=</span> <span class="st">"Age"</span><span class="op">)</span>
<span class="co">#&gt; $p.perm</span>
<span class="co">#&gt; [1] 0.1466</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $plot</span></code></pre></div>
<p><img src="Using-sneasy-package_files/figure-html/unnamed-chunk-34-1.png" width="700"></p>
<p>Inspecting the plot is important because it will tell you if something has gone very wrong (e.g., if you don’t see a bell curve), but if you only want the p<sub>perm</sub> value, you can use the argument <code>plot = FALSE</code>.</p>
<p>Here, we see that the effect of age on degree centrality is not significant: p<sub>perm</sub> &gt; .05 and the observed line falls within the red significance cut off lines. This makes sense, since the age data was randomly generated—if it did significantly predict degree centrality, we would know it was a fluke!</p>
</div>
<div id="additional-functions" class="section level1">
<h1 class="hasAnchor">
<a href="#additional-functions" class="anchor"></a>Additional functions</h1>
<div id="rescale-data-from-0-to-1" class="section level2">
<h2 class="hasAnchor">
<a href="#rescale-data-from-0-to-1" class="anchor"></a>Rescale data from 0 to 1</h2>
<p>As shown above, <code>rescale01</code> scales a vector to range from 0 to 1. By default it will set the minimum value included in the vector to 0 and the maximum value included in the vector to 1:</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">v</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span>
<span class="fu"><a href="../reference/rescale01.html">rescale01</a></span><span class="op">(</span><span class="va">v</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.0000000 0.3333333 0.6666667 1.0000000</span></code></pre></div>
<p>If there is actually a different minimum value that should be set to 0 or a different maximum value that should be set to 1, make sure to specify that.</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/rescale01.html">rescale01</a></span><span class="op">(</span><span class="va">v</span>, min<span class="op">=</span><span class="fl">0</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.25 0.50 0.75 1.00</span>
<span class="fu"><a href="../reference/rescale01.html">rescale01</a></span><span class="op">(</span><span class="va">v</span>, max<span class="op">=</span><span class="fl">5</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.00 0.25 0.50 0.75</span>
<span class="fu"><a href="../reference/rescale01.html">rescale01</a></span><span class="op">(</span><span class="va">v</span>, min<span class="op">=</span><span class="fl">0</span>, max<span class="op">=</span><span class="fl">5</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.2 0.4 0.6 0.8</span></code></pre></div>
</div>
<div id="grand-mean-center-a-vector" class="section level2">
<h2 class="hasAnchor">
<a href="#grand-mean-center-a-vector" class="anchor"></a>Grand mean center a vector</h2>
<p>If you are using continuous variables as predictors or covariates in your model and you want your regression intercept to represent your dependent variable at the mean level of the continuous variable(s), you should grand mean center the variable(s) before putting them into the model. The intercept will always estimate the dependent variable when all continuous variables in the model equal 0. That might be meaningful for some variables (e.g., if you are examining the effect of bias on racial diversity of friends, it would make sense to estimate racial diversity for people with 0 bias), but it doesn’t make sense for many variables. For example, in our model above regressing age on degree centrality, the intercept estimates degree centrality when age = 0, which doesn’t make sense (degree centrality at birth?). Instead, it would make more sense to get an estimate of degree centrality at the average age in the sample.</p>
<p>Grand mean centering simply adjusts the variable by subtracting the mean from every value, so that the average = 0 (values lower than the average will become negative).</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/gmc.html">gmc</a></span><span class="op">(</span><span class="va">v</span><span class="op">)</span>
<span class="co">#&gt; [1] -1.5 -0.5  0.5  1.5</span></code></pre></div>
<p>We can see how this makes a difference for the intercept in the model we ran earlier.</p>
<p>Original model:</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; lm(formula = degree ~ age, data = d)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residuals:</span>
<span class="co">#&gt;     Min      1Q  Median      3Q     Max </span>
<span class="co">#&gt; -5.1067 -3.1764 -0.1764  2.5135 10.5135 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)</span>
<span class="co">#&gt; (Intercept)  -1.4057     4.3746  -0.321    0.748</span>
<span class="co">#&gt; age           0.3101     0.2340   1.326    0.186</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residual standard error: 3.481 on 326 degrees of freedom</span>
<span class="co">#&gt; Multiple R-squared:  0.005361,   Adjusted R-squared:  0.002309 </span>
<span class="co">#&gt; F-statistic: 1.757 on 1 and 326 DF,  p-value: 0.1859</span></code></pre></div>
<p>Model with age grand mean centered:</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">d</span> <span class="op">&lt;-</span> <span class="va">d</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span><span class="op">(</span>agec <span class="op">=</span> <span class="fu"><a href="../reference/gmc.html">gmc</a></span><span class="op">(</span><span class="va">age</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">degree</span> <span class="op">~</span> <span class="va">agec</span>, data <span class="op">=</span> <span class="va">d</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; lm(formula = degree ~ agec, data = d)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residuals:</span>
<span class="co">#&gt;     Min      1Q  Median      3Q     Max </span>
<span class="co">#&gt; -5.1067 -3.1764 -0.1764  2.5135 10.5135 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="co">#&gt; (Intercept)   4.3872     0.1922  22.825   &lt;2e-16 ***</span>
<span class="co">#&gt; agec          0.3101     0.2340   1.326    0.186    </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residual standard error: 3.481 on 326 degrees of freedom</span>
<span class="co">#&gt; Multiple R-squared:  0.005361,   Adjusted R-squared:  0.002309 </span>
<span class="co">#&gt; F-statistic: 1.757 on 1 and 326 DF,  p-value: 0.1859</span></code></pre></div>
<p>The first model’s intercept gives us a nonsensical estimate that degree centrality at birth is -1.41, whereas the second model gives us the useful information that estimated degree centrality at the average age in the sample is 4.39.</p>
</div>
</div>
<div id="references" class="section level1">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<p>Farine, D. R. (2017). A guide to null models for animal social network analysis. <em>Methods in Ecology and Evolution</em>, 1–12. <a href="https://doi.org/10.1111/2041-210X.12772" class="uri">https://doi.org/10.1111/2041-210X.12772</a></p>
<p>Turetsky, K. M., Purdie-Greenaway, V., Cook, J. E., Curley, J. P., &amp; Cohen, G. L. (2020). A psychological intervention strengthens students’ peer social networks and promotes persistence in STEM. <em>Science Advances, 6</em>(45), eaba9221. <a href="https://doi.org/10.1126/sciadv.aba9221" class="uri">https://doi.org/10.1126/sciadv.aba9221</a></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Kate Turetsky.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
